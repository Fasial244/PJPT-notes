# Test Day – YYYY‑MM‑DD

This document summarises the key findings from my final exam/test‑day environment.  Specific hostnames and credentials have been generalised for security.

## Environment overview

- **Domain:** The lab network was a single Windows domain (e.g., `****.local`).
- **Hosts:** Three critical hosts were identified: a domain controller and two workstations (`WS‑1`, `WS‑2`).  Each machine was enumerated via Nmap to confirm OS versions and open ports.
- **OS detection:** Nmap OS fingerprinting suggested older Windows versions (e.g., Windows XP SP3 or Server 2003) with SMB ports 139/445 open.  Further enumeration confirmed the domain controller via SMB banners.

## Enumeration & exploitation

1. **SMB enumeration:** Using `enum4linux` and `smbclient` I listed shared folders and enumerated domain users.  SMB signing was disabled, allowing for a successful relay attack.
2. **Responder & ntlmrelayx:** I ran Responder to poison LLMNR/NBT‑NS traffic and captured NTLMv2 hashes.  `ntlmrelayx.py` relayed these to the domain controller’s LDAP service and created a new domain admin account.
3. **Password cracking:** Captured hashes were cracked with Hashcat, revealing a password format `****`.  These credentials granted local admin rights on the workstations.
4. **LSA & DPAPI secrets:** After obtaining a shell on the domain controller via `psexec.py`, I dumped LSA secrets and DPAPI backup keys.  These included machine account passwords and encryption keys.
5. **Token impersonation:** I used `mimikatz` to duplicate a high‑privilege token and impersonate the domain administrator.  This bypassed restrictions that limit token creation by standard users.

## Lessons learned

- **SMB signing matters:** Disabling SMB signing allows credential relays and should be avoided.
- **LLMNR/NBT‑NS:** These protocols are unnecessary in most environments and make Responder attacks trivial.
- **Credential hygiene:** Reusing simple passwords across multiple machine accounts enabled lateral movement.
- **Token protections:** Limiting who can create or impersonate tokens mitigates privilege escalation.

## Remediation recommendations

- Enable SMB signing and disable LLMNR/NBT‑NS on all hosts.
- Enforce unique, complex passwords for local machine accounts and service accounts.
- Restrict the ability to create and impersonate tokens to privileged groups only.
- Regularly monitor and audit authentication logs to detect relay attacks.

This summary captures the methodology and key takeaways without exposing sensitive credentials from the actual exam.
